\documentclass{article}
\usepackage[ae,hyper]{Rd}


%\VignetteIndexEntry{AquaEnv-PrivateFunctions}


\title{The PRIVATE functions of package AquaEnv}
\author{Andreas F. Hofmann}




\begin{document}

\maketitle

\HeaderA{Abi}{Abi}{Abi}
\keyword{misc}{Abi}
\begin{Description}\relax
PRIVATE function: calculates [A(2-)] of a bivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}Abi(Sum, K1, K2, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{Atri}{Atri}{Atri}
\keyword{misc}{Atri}
\begin{Description}\relax
PRIVATE function: calculates [A(3-)] of a trivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}Atri(Sum, K1, K2, K3, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{Auni}{Auni}{Auni}
\keyword{misc}{Auni}
\begin{Description}\relax
PRIVATE function: calculates [A(-)] of an univalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}Auni(Sum, K, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K }] the dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{Cl}{Cl}{Cl}
\keyword{misc}{Cl}
\begin{Description}\relax
PRIVATE function: calculates chlorinity Cl from salinity S
\end{Description}
\begin{Usage}
\begin{verbatim}Cl(S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
chlorinity Cl in permil
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
DOE1994, Zeebe2001
\end{References}

\HeaderA{ConcRelCl}{ConcRelCl}{ConcRelCl}
\keyword{misc}{ConcRelCl}
\begin{Description}\relax
PUBLIC data frame: a collection of concentrations of key chemical species in seawater, relative with respect to chlorinity (DOE1994))
\end{Description}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{H2Abi}{H2Abi}{H2Abi}
\keyword{misc}{H2Abi}
\begin{Description}\relax
PRIVATE function: calculates [H2A] of a bivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}H2Abi(Sum, K1, K2, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{H2Atri}{H2Atri}{H2Atri}
\keyword{misc}{H2Atri}
\begin{Description}\relax
PRIVATE function: calculates [H2A(-)] of a trivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}H2Atri(Sum, K1, K2, K3, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{H3Atri}{H3Atri}{H3Atri}
\keyword{misc}{H3Atri}
\begin{Description}\relax
PRIVATE function: calculates [H3A] of a trivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}H3Atri(Sum, K1, K2, K3, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{HAbi}{HAbi}{HAbi}
\keyword{misc}{HAbi}
\begin{Description}\relax
PRIVATE function: calculates [HA(-)] of a bivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}HAbi(Sum, K1, K2, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{HAtri}{HAtri}{HAtri}
\keyword{misc}{HAtri}
\begin{Description}\relax
PRIVATE function: calculates [HA(2-)] of a trivalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}HAtri(Sum, K1, K2, K3, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{HAuni}{HAuni}{HAuni}
\keyword{misc}{HAuni}
\begin{Description}\relax
PRIVATE function: calculates [HA] of an univalent acid
\end{Description}
\begin{Usage}
\begin{verbatim}HAuni(Sum, K, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{Sum }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K }] the dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{I}{I}{I}
\keyword{misc}{I}
\begin{Description}\relax
PRIVATE function: calculates the ionic strength I as a function of salinity S
\end{Description}
\begin{Usage}
\begin{verbatim}I(S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
ionic strength in mol/kg-H2O (molality)
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
DOE1994, Zeebe2001, Roy1993b (the carbonic acid paper)
\end{References}

\HeaderA{Iterms}{Iterms}{Iterms}
\keyword{misc}{Iterms}
\begin{Description}\relax
PRIVATE function: returns the ionic strenght I, I(2), sqrt(I), and I*sqrt(I)
\end{Description}
\begin{Usage}
\begin{verbatim}Iterms(S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
a list containing:
\begin{ldescription}
\item[\code{I }] the ionic strength
\item[\code{I\textasciicircum{}2 }] the square of the ionic strength
\item[\code{sqrtI }] the square root of the ionic strength
\item[\code{I*sqrtI }] the ionic strength times its square root
\end{ldescription}
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{Sterms}{Sterms}{Sterms}
\keyword{misc}{Sterms}
\begin{Description}\relax
PRIVATE function: returns S, S(2), sqrt(S), and S*sqrt(S)
\end{Description}
\begin{Usage}
\begin{verbatim}Sterms(S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
a list containing:
\begin{ldescription}
\item[\code{S\textasciicircum{}2 }] the square of S
\item[\code{sqrtS }] the square root of S
\item[\code{S*sqrtS }] S times its square root
\end{ldescription}
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{T}{T}{T}
\keyword{misc}{T}
\begin{Description}\relax
PRIVATE function: calculates the temperature in Kelvin from the temperature in degrees centigrade
\end{Description}
\begin{Usage}
\begin{verbatim}T(t)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{t }] temperature in degrees centigrade
\end{ldescription}
\end{Arguments}
\begin{Value}
temperature in Kelvin
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}



\HeaderA{att}{att}{att}
\keyword{misc}{att}
\begin{Description}\relax
PRIVATE function: sets the attributes for calculated dissociation constants (Ks)
\end{Description}
\begin{Usage}
\begin{verbatim}att(K)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{K }] the calculated dissociation constant K
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{basicplot}{basicplot}{basicplot}
\keyword{IO}{basicplot}
\begin{Description}\relax
PRIVATE function: basic wrapper for the R plot function for plotting objects of class aquaenv; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}basicplot(aquaenv, xval, type="l", mgp=c(1.8, 0.5, 0),
          mar=c(3,3,0.5,0.5), oma=c(0,0,0,0), size=c(15,13),
          mfrow=c(11,10), device="x11", filename="aquaenv",
          newdevice, setpar,...)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{xval }] x-value: the independent variable describing a change in elements of an object of class aquaenv
\item[\code{type }] standard plot parameter;     default: plot lines
\item[\code{mgp }] standard plot parameter;     default: axis title on line 1.8, axis labels on line 0.5, axis on line 0
\item[\code{mar }] standard plot parameter;     default: margin of 3 lines bottom and left and 0.5 lines top and right
\item[\code{oma }] standard plot parameter;     default: no outer margin
\item[\code{size }] the size of the plot device; default: 15 (width) by 13 (height) inches
\item[\code{mfrow }] standard plot parameter;     default: 11 columns and 10 rows of plots
\item[\code{device }] the device to plot on;       default: "x11" (can also be "eps" or "pdf")
\item[\code{filename }] filename to be used if "eps" or "pdf" is selected for
device
\item[\code{newdevice}] flag: if TRUE, new plot device is opened
\item[\code{setpar}] flag: if TRUE parameters are set with the function par
\item[\code{... }] further arguments will be passed
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{bjerrumplot}{bjerrumplot}{bjerrumplot}
\keyword{IO}{bjerrumplot}
\begin{Description}\relax
PRIVATE function: creates a bjerrumplot from the elements of an object of class aquaenv given in what; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}bjerrumplot(aquaenv, what, log=FALSE, palette=NULL, device="x11",
            filename="aquaenv", size=c(12,10), ylim=NULL,
            lwd=2, xlab="free scale pH",
            mgp=c(1.8, 0.5, 0), mar=c(3,3,0.5,0.5), oma=c(0,0,0,0),
            legendposition="bottomleft", legendinset=0.05, legendlwd=4,
            bg="white", newdevice, setpar,...)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{what }] vector of names of elements of aquaenv that should be plotted; if not specified:  what <- c("CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH", "H3PO4", "H2PO4", "HPO4", "PO4", "SiOH4", "SiOOH3", "SiO2OH2", "H2S", "HS", "S2min", "NH4", "NH3", "H2SO4", "HSO4", "SO4", "HF", "F", "HNO3", "NO3", "HNO2", "NO2")
\item[\code{log }] should the plot be on a logarithmic y axis?
\item[\code{palette }] a vector of colors to use in the plot (either numbers or names given in colors())
\item[\code{device }] the device to plot on; default: "x11" (can also be "eps" or "pdf")
\item[\code{filename }] filename to be used if "eps" or "pdf" is selected for device
\item[\code{size }] the size of the plot device; default: 12 (width) by 10 (height) inches
\item[\code{ylim }] standard plot parameter; if not supplied it will be calculated by range() of the elements to plot
\item[\code{lwd }] standard plot parameter; width of the lines in the plot
\item[\code{xlab }] x axis label
\item[\code{mgp }] standard plot parameter; default: axis title on line 1.8, axis labels on line 0.5, axis on line 0
\item[\code{mar }] standard plot parameter; default: margin of 3 lines bottom and left and 0.5 lines top and right
\item[\code{oma }] standard plot parameter; default: no outer margin
\item[\code{legendposition }] position of the legend
\item[\code{legendinset }] standard legend parameter inset
\item[\code{legendlwd }] standard legend parameter lwd: line width of lines in legend
\item[\code{bg }] standard legend parameter: default background color: white
\item[\code{newdevice}] flag: if TRUE, new plot device is opened
\item[\code{setpar}] flag: if TRUE parameters are set with the function par
\item[\code{... }] further arguments will be passed
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{calcH\_CO2}{calcH\_CO2}{calcH.Rul.CO2}
\keyword{misc}{calcH\_CO2}
\begin{Description}\relax
PRIVATE function: calculates [H+]  from an object of class aquanenv and a given [CO2]: by analytically solving the resulting quadratic equation
\end{Description}
\begin{Usage}
\begin{verbatim}calcH_CO2(aquaenv, CO2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{CO2 }] given [CO2] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated [H+] in mol/kg-solution
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcH\_TA}{calcH\_TA}{calcH.Rul.TA}
\keyword{misc}{calcH\_TA}
\begin{Description}\relax
PRIVATE function: calculates [H+]  from an object of class aquanenv and a given [TA]: first according to Follows2006, if no solution is found after Technicals\$maxiter iterations, uniroot is applied
\end{Description}
\begin{Usage}
\begin{verbatim}calcH_TA(aquaenv, TA)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{TA }] given [TA] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated [H+] in mol/kg-solution
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcSumCO2\_TA\_CO2}{calcSumCO2\_TA\_CO2}{calcSumCO2.Rul.TA.Rul.CO2}
\keyword{misc}{calcSumCO2\_TA\_CO2}
\begin{Description}\relax
PRIVATE function: calculates [SumCO2] from an object of class aquanenv, a given [TA], and a given [CO2]: by analytically solving the resulting quadratic equation
\end{Description}
\begin{Usage}
\begin{verbatim}calcSumCO2_TA_CO2(aquaenv, TA, CO2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{TA }] given [TA] in mol/kg-solution
\item[\code{CO2 }] given [CO2] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated [SumCO2] in mol/kg-solution
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcSumCO2\_pH\_CO2}{calcSumCO2\_pH\_CO2}{calcSumCO2.Rul.pH.Rul.CO2}
\keyword{misc}{calcSumCO2\_pH\_CO2}
\begin{Description}\relax
PRIVATE function: calculates [SumCO2]  from an object of class aquanenv, a given pH, and a given [CO2]: by analytically solving the resulting equation
\end{Description}
\begin{Usage}
\begin{verbatim}calcSumCO2_pH_CO2(aquaenv, pH, CO2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{pH }] given pH on the free proton scale
\item[\code{CO2 }] given [CO2] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated [SumCO2] in mol/kg-solution
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcSumCO2\_pH\_TA}{calcSumCO2\_pH\_TA}{calcSumCO2.Rul.pH.Rul.TA}
\keyword{misc}{calcSumCO2\_pH\_TA}
\begin{Description}\relax
PRIVATE function: calculates [SumCO2]  from an object of class aquanenv, a given pH, and a given [TA]: by analytically solving the resulting quadratic equation
\end{Description}
\begin{Usage}
\begin{verbatim}calcSumCO2_pH_TA(aquaenv, pH, TA)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{pH }] given pH on the free proton scale
\item[\code{TA }] given [TA] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated [SumCO2] in mol/kg-solution
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcTA}{calcTA}{calcTA}
\keyword{misc}{calcTA}
\begin{Description}\relax
PRIVATE function: calculates [TA] from an object of class aquanenv and a given [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}calcTA(aquaenv, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)given [H+] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
the calculated [TA]
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{calcTAMinor}{calcTAMinor}{calcTAMinor}
\keyword{misc}{calcTAMinor}
\begin{Description}\relax
PRIVATE function: calculates minor contributions to [TA] from an object of class aquanenv and a given [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}calcTAMinor(aquaenv, H)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)given [H+] in mol/kg-solution
\end{ldescription}
\end{Arguments}
\begin{Value}
calculated minor contributions to [TA]
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{cloneaquaenv}{cloneaquaenv}{cloneaquaenv}
\keyword{misc}{cloneaquaenv}
\begin{Description}\relax
PRIVATE function: clones an object of class aquaenv: it is possible to supply a new value for either TA or pH; the switches speciation, skeleton, revelle, and dsa are obtained from the object to be cloned
\end{Description}
\begin{Usage}
\begin{verbatim}cloneaquaenv(aquaenv, TA=NULL, pH=NULL, k_co2=NULL, k1k2="roy", khf="dickson")\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{TA }] optional new value for TA
\item[\code{pH }] optional new value for pH
\item[\code{k\_co2}] used for TA fitting: give a K\_CO2 and NOT calculate it from T and S: i.e. K\_CO2 can be fitted in the routine as well
\item[\code{k1k2}] either "roy" (default, Roy1993a) or "lueker" (Lueker2000, calculated with seacarb) for K\_CO2 and K\_HCO3.
\item[\code{khf}] either "dickson" (default, Dickson1979a) or "perez" (Perez1987a, calculated with seacarb) for K\_HF
\end{ldescription}
\end{Arguments}
\begin{Value}
cloned object of class aquaenv
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{convert.standard}{convert.standard}{convert.standard}
\keyword{misc}{convert.standard}
\begin{Description}\relax
PRIVATE function: converts either the pH scale of a pH value, the pH scale of a dissociation constant (K*), or the unit of a concentration value
\end{Description}
\begin{Usage}
\begin{verbatim}convert.standard(x, vartype, what, S, t, p=0, SumH2SO4=NULL,
                  SumHF=NULL, khf="dickson")\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{x }] the object to be converted (pH value, K* value, or concentration value)
\item[\code{vartype }] the type of x, either "pHscale", "KHscale", or "conc"
\item[\code{what }] the type of conversion to be done, for pH scales one of "free2tot", "free2sws", "free2nbs", ... (any combination of "free", "tot", "sws", and "nbs"); for concentrations one of "molar2molal", "molar2molin", ... (any combination of "molar" (mol/l), "molal" (mol/kg-H2O), and "molin" (mol/kg-solution))
\item[\code{S }] salinity (in practical salinity units: no unit)
\item[\code{t }] temperature in degrees centigrade
\item[\code{p }] gauge pressure (total pressure minus atmospheric pressure) in bars
\item[\code{SumH2SO4 }] total sulfate concentration in mol/kg-solution; if not supplied this is calculated from S
\item[\code{SumHF }] total fluoride concentration in mol/kg-solution; if not supplied this is calculated from S
\item[\code{khf}] either "dickson" (default, Dickson1979a) or "perez" (using seacarb, Perez1987a) for K\_HF
\end{ldescription}
\end{Arguments}
\begin{Value}
converted pH, K*, or concentration value, attributed with the new unit/pH scale
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{cumulativeplot}{cumulativeplot}{cumulativeplot}
\keyword{IO}{cumulativeplot}
\begin{Description}\relax
PRIVATE function: creates a cumulative plot from the elements of an object of class aquaenv given in what; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}cumulativeplot(aquaenv, xval, what, total=TRUE, palette=NULL,
               device="x11", filename="aquaenv", size=c(12,10),
               ylim=NULL, lwd=2, mgp=c(1.8, 0.5, 0),
               mar=c(3,3,0.5,0.5), oma=c(0,0,0,0),
               legendposition="bottomleft", legendinset=0.05,
               legendlwd=4, bg="white",
               y.intersp=1.2, newdevice, setpar,...)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{xval }] x-value: the independent variable describing a change in elements of an object of class aquaenv
\item[\code{what }] vector of names of elements of aquaenv that should be plotted
\item[\code{total }] should the sum of all elements specified in what be plotted as well?
\item[\code{palette }] a vector of colors to use in the plot (either numbers or names given in colors())
\item[\code{device }] the device to plot on;       default: "x11" (can also be "eps" or "pdf")
\item[\code{filename }] filename to be used if "eps" or "pdf" is selected for device
\item[\code{size }] the size of the plot device; default: 12 (width) by 10 (height) inches
\item[\code{ylim }] standard plot parameter; if not supplied it will be calculated by an adaptation of range() of the elements to plot
\item[\code{lwd }] standard plot parameter; width of the lines in the plot
\item[\code{mgp }] standard plot parameter; default: axis title on line 1.8, axis labels on line 0.5, axis on line 0
\item[\code{mar }] standard plot parameter; default: margin of 3 lines bottom and left and 0.5 lines top and right
\item[\code{oma }] standard plot parameter; default: no outer margin
\item[\code{legendposition }] position of the legend
\item[\code{legendinset }] standard legend parameter inset
\item[\code{legendlwd }] standard legend parameter lwd: line width of lines in legend
\item[\code{bg }] standard legend parameter: default background color: white
\item[\code{y.intersp }] standard legend parameter; default: 1.2 lines space
between the lines in the legend
\item[\code{newdevice}] flag: if TRUE, new plot device is opened
\item[\code{setpar}] flag: if TRUE parameters are set with the function par
\item[\code{... }] further arguments will be passed
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dAdH\_bi}{dAdH\_bi}{dAdH.Rul.bi}
\keyword{misc}{dAdH\_bi}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [A(2-)] of a bivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dAdH_bi(H, SumA, K1, K2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dAdH\_tri}{dAdH\_tri}{dAdH.Rul.tri}
\keyword{misc}{dAdH\_tri}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [A(3-)] of a trivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dAdH_tri(H, SumA, K1, K2, K3)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dAdH\_uni}{dAdH\_uni}{dAdH.Rul.uni}
\keyword{misc}{dAdH\_uni}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [A(-)] of a univalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dAdH_uni(H, SumA, K)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K }] the dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dH2AdH\_bi}{dH2AdH\_bi}{dH2AdH.Rul.bi}
\keyword{misc}{dH2AdH\_bi}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [H2A] of a bivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dH2AdH_bi(H, SumA, K1, K2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dH2AdH\_tri}{dH2AdH\_tri}{dH2AdH.Rul.tri}
\keyword{misc}{dH2AdH\_tri}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [H2A(-)] of a trivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dH2AdH_tri(H, SumA, K1, K2, K3)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dH3AdH\_tri}{dH3AdH\_tri}{dH3AdH.Rul.tri}
\keyword{misc}{dH3AdH\_tri}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [H3A] of a trivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dH3AdH_tri(H, SumA, K1, K2, K3)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dHAdH\_bi}{dHAdH\_bi}{dHAdH.Rul.bi}
\keyword{misc}{dHAdH\_bi}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [HA(-)] of a bivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dHAdH_bi(H, SumA, K1, K2)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dHAdH\_tri}{dHAdH\_tri}{dHAdH.Rul.tri}
\keyword{misc}{dHAdH\_tri}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [HA(2-)] of a trivalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dHAdH_tri(H, SumA, K1, K2, K3)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all othert input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K1 }] the first dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K2 }] the second dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K3 }] the third dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dHAdH\_uni}{dHAdH\_uni}{dHAdH.Rul.uni}
\keyword{misc}{dHAdH\_uni}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [HA] of a univalent acid with respect to [H+]
\end{Description}
\begin{Usage}
\begin{verbatim}dHAdH_uni(H, SumA, K)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{H }] the proton concentration in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{SumA }] the total concentration of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\item[\code{K }] the dissociation constant of the acid in question in a unit consistent with all other input variables (e.g. mol/kg-solution)
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdH}{dTAdH}{dTAdH}
\keyword{misc}{dTAdH}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to [H+]: the buffer factor
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdH(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to [H+]: the buffer factor
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdKdKdS}{dTAdKdKdS}{dTAdKdKdS}
\keyword{misc}{dTAdKdKdS}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to salinity S
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdKdKdS(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to salinity S
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdKdKdSumH2SO4}{dTAdKdKdSumH2SO4}{dTAdKdKdSumH2SO4}
\keyword{misc}{dTAdKdKdSumH2SO4}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to the total sulfate concentration (influence via scale conversion)
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdKdKdSumH2SO4(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to the total sulfate concentration (influence via scale conversion)
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdKdKdSumHF}{dTAdKdKdSumHF}{dTAdKdKdSumHF}
\keyword{misc}{dTAdKdKdSumHF}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to the total fluoride concentration (influence via scale conversion)
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdKdKdSumHF(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to the total fluoride concentration (influence via scale conversion)
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdKdKdT}{dTAdKdKdT}{dTAdKdKdT}
\keyword{misc}{dTAdKdKdT}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to temperature T
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdKdKdT(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to temperature T
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{dTAdKdKdp}{dTAdKdKdp}{dTAdKdKdp}
\keyword{misc}{dTAdKdKdp}
\begin{Description}\relax
PRIVATE function: calculates the derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to gauge pressure p
\end{Description}
\begin{Usage}
\begin{verbatim}dTAdKdKdp(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
derivative of [TA] with respect to changes in the dissociation constants (Ks) times the derivative of the dissociation constants with respect to gauge pressure p 
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{deltaPlnK}{deltaPlnK}{deltaPlnK}
\keyword{misc}{deltaPlnK}
\begin{Description}\relax
PRIVATE function: the generic function for the pressure correction for dissociation constants and solubility products according to Millero1995
\end{Description}
\begin{Usage}
\begin{verbatim}deltaPlnK(T, d, coeff)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{T }] temperature in Kelvin
\item[\code{d }] the depth in meters
\item[\code{coeff }] a vector containing the coefficients a0, a1, a2, b0, b1, b2 for the respective dissociation constant or solubility product
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
Millero1995, corrected by Lewis1998
\end{References}

\HeaderA{from.data.frame}{from.data.frame}{from.data.frame}
\keyword{misc}{from.data.frame}
\begin{Description}\relax
PRIVATE function: creates an object of class aquaenv from a data frame (e.g. as supplied from the numerical solver of a dynamic model)
\end{Description}
\begin{Usage}
\begin{verbatim}from.data.frame(df)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{df }] data frame
\end{ldescription}
\end{Arguments}
\begin{Value}
object of class aquaenv
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{lnK}{lnK}{lnK}
\keyword{misc}{lnK}
\begin{Description}\relax
PRIVATE function: generic formula (see publication associated with AquaEnv) for K calculations that use the natural logarithm (ln)
\end{Description}
\begin{Usage}
\begin{verbatim}lnK(A, B, C, D, E, T)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{A }] coefficient A
\item[\code{B }] coefficient B
\item[\code{C }] coefficient C
\item[\code{D }] coefficient D
\item[\code{E }] coefficient E
\item[\code{T }] temperature in Kelvin
\end{ldescription}
\end{Arguments}
\begin{Value}
the ln of the K associated with the coefficients
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{logK}{logK}{logK}
\keyword{misc}{logK}
\begin{Description}\relax
PRIVATE function: generic formula (see publication associated with AquaEnv) for K calculations that use the decadal logarithm (log)
\end{Description}
\begin{Usage}
\begin{verbatim}logK(A, B, C, D, E, T)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{A }] coefficient A
\item[\code{B }] coefficient B
\item[\code{C }] coefficient C
\item[\code{D }] coefficient D
\item[\code{E }] coefficient E
\item[\code{T }] temperature in Kelvin
\end{ldescription}
\end{Arguments}
\begin{Value}
the log of the K associated with the coefficients
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{molal2molin}{molal2molin}{molal2molin}
\keyword{misc}{molal2molin}
\begin{Description}\relax
PRIVATE function: calculates the conversion factor converting from molality (mol/kg-H2O) to molinity (mol/kg-solution) from salinity S
\end{Description}
\begin{Usage}
\begin{verbatim}molal2molin(S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
the conversion factor from molality (mol/kg-H2O) to molinity (mol/kg-solution)
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
Roy1993b (the carbonic acid paper), DOE1994
\end{References}

\HeaderA{opendevice}{opendevice}{opendevice}
\keyword{IO}{opendevice}
\begin{Description}\relax
PRIVATE function: opens a device for plotting; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}opendevice(device, size, filename)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{device }] either "x11", "eps", or "pdf"
\item[\code{size }] size of the plot device in the form c(width, height)
\item[\code{filename }] filename to use if "eps" or "pdf" is used
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\HeaderA{plotall}{plotall}{plotall}
\keyword{IO}{plotall}
\begin{Description}\relax
PRIVATE function: plots all elements of an object of class aquaenv; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}plotall(aquaenv, xval, ...)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{xval }] x-value: the independent variable describing a change in elements of an object of class aquaenv
\item[\code{... }] further arguments will be passed
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{revelle}{revelle}{revelle}
\keyword{misc}{revelle}
\begin{Description}\relax
PRIVATE function: calculates the revelle factor
\end{Description}
\begin{Usage}
\begin{verbatim}revelle(ae)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ae }] object of class aquaenv
\end{ldescription}
\end{Arguments}
\begin{Value}
the revelle factor
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
Sundquist1979, Zeebe2001, Emerson2008
\end{References}


\HeaderA{scaleconvert}{scaleconvert}{scaleconvert}
\keyword{misc}{scaleconvert}
\begin{Description}\relax
PRIVATE function: provides pH scale conversion factors (caution: the activity coefficient for H+ (needed for NBS scale conversions) is calculated with the Davies equation (Zeebe2001) which is only accurate up to ionic strengthes of I = 0.5)
\end{Description}
\begin{Usage}
\begin{verbatim}scaleconvert(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson")\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\item[\code{t }] temperature in degrees centigrade
\item[\code{p }] gauge pressure (total pressure minus atmospheric pressure) in bars
\item[\code{SumH2SO4 }] total sulfate concentration in mol/kg-solution; if not supplied this is calculated from S
\item[\code{SumHF }] total fluoride concentration in mol/kg-solution; if not
supplied this is calculated from S
\item[\code{khf}] either "dickson" (default, Dickson1979a) or "perez" (using seacarb, Perez1987a) for K\_HF
\end{ldescription}
\end{Arguments}
\begin{Value}
a list of conversion factors "free2tot", "free2sws", etc.
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
Dickson1984, DOE1994, Zeebe2001
\end{References}

\HeaderA{seaconc}{seaconc}{seaconc}
\keyword{misc}{seaconc}
\begin{Description}\relax
PRIVATE function: calculates concentrations of constituents of natural seawater from a given salinity S
\end{Description}
\begin{Usage}
\begin{verbatim}seaconc(spec, S)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{spec }] constituent of seawater (chemical species) of which the concentration should be calculated. can be any name of the vectors ConcRelCl and MeanMolecularWeight: "Cl", "SO4", "Br", "F", "Na", "Mg", "Ca", "K", "Sr", "B", "S"
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\end{ldescription}
\end{Arguments}
\begin{Value}
concentration of the constituent of seawater speciefied in spec in mol/kg-solution (molinity): this is determined by the data in ConcRelCl and MeanMolecularWeight
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
DOE1994
\end{References}

\HeaderA{seadensity}{seadensity}{seadensity}
\keyword{misc}{seadensity}
\begin{Description}\relax
PRIVATE function: calculates seawater density (in kg/m3) from temperature (in degrees centigrade) and salinity
\end{Description}
\begin{Usage}
\begin{verbatim}seadensity(S, t)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{S }] salinity S in practical salinity units (i.e. no unit)
\item[\code{t }] temperature in degrees centigrade
\end{ldescription}
\end{Arguments}
\begin{Value}
seawater density in kg/m3
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}
\begin{References}\relax
Millero1981, DOE1994
\end{References}

\HeaderA{selectplot}{selectplot}{selectplot}
\keyword{IO}{selectplot}
\begin{Description}\relax
PRIVATE function: plots just the elements of an object of class aquaenv given in what; no return value, just side-effect
\end{Description}
\begin{Usage}
\begin{verbatim}selectplot(aquaenv, xval, what, mfrow=c(1,1), size=c(7,7), ...)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{aquaenv }] object of class aquaenv
\item[\code{xval }] x-value: the independent variable describing a change in elements of an object of class aquaenv
\item[\code{what }] vector of names of elements of aquaenv that should be plotted
\item[\code{mfrow }] standard plot parameter; default: just one plot
\item[\code{size }] the size of the plot device; default: 7 (width) by 7 (height) inches
\item[\code{... }] further arguments will be passed
\end{ldescription}
\end{Arguments}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{splitS\_K\_CO2}{splitS\_K\_CO2}{splitS.Rul.K.Rul.CO2}
\keyword{misc}{splitS\_K\_CO2}
\begin{Description}\relax
PRIVATE function: returns the intersection of the formulae for K\_CO2 for S < 5 and S >= 5
\end{Description}
\begin{Usage}
\begin{verbatim}splitS_K_CO2(T)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{T }] temperature in Kelvin
\end{ldescription}
\end{Arguments}
\begin{Value}
the value for S where the two formulae intersect at temperature T
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}

\HeaderA{splitS\_K\_HCO3}{splitS\_K\_HCO3}{splitS.Rul.K.Rul.HCO3}
\keyword{misc}{splitS\_K\_HCO3}
\begin{Description}\relax
PRIVATE function: returns the intersection of the formulae for K\_HCO3 for S < 5 and S >= 5
\end{Description}
\begin{Usage}
\begin{verbatim}splitS_K_HCO3(T)\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{T }] temperature in Kelvin
\end{ldescription}
\end{Arguments}
\begin{Value}
the value for S where the two formulae intersect at temperature T
\end{Value}
\begin{Author}\relax
Andreas F. Hofmann (a.hofmann@nioo.knaw.nl)
\end{Author}


\end{document}
